@page "/"
@inject AuthenticationService AuthService
@inject NavigationManager NavigationManager
@namespace BlazorAuth.Pages

<div class="vh-100 d-flex align-items-center justify-content-center background-gradient">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card shadow-lg border-0 rounded-lg">
                    <div class="card-body text-center p-5">

                        <h1 class="display-4 fw-bold text-primary mb-3">BTPBatimentPro</h1>
                        <p class="lead text-muted mb-4">Votre plateforme professionnelle pour le BTP</p>

                        @if (!isAuthenticated)
                        {
                            <NavLink href="/login" class="btn btn-primary btn-lg px-5 py-3 rounded-pill shadow-sm">
                                <i class="bi bi-box-arrow-in-right me-2"></i>
                                Se connecter
                            </NavLink>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .background-gradient {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    }

    .card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        transition: transform 0.3s ease;
    }

    .card:hover {
        transform: translateY(-5px);
    }

    .btn-primary {
        background: linear-gradient(45deg, #007bff, #0056b3);
        border: none;
        transition: all 0.3s ease;
    }

    .btn-primary:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0, 123, 255, 0.4) !important;
    }
</style>

@code {
    private bool isAuthenticated;

    protected override async Task OnInitializedAsync()
    {
        isAuthenticated = await AuthService.IsAuthenticated();
        if (isAuthenticated)
        {
            var roles = await AuthService.GetUserRoles();
            if (roles.Contains("Admin"))
            {
                NavigationManager.NavigateTo("/admin/dashboard", forceLoad: true);
            }
            else if (roles.Contains("User"))
            {
                NavigationManager.NavigateTo("/user/dashboard", forceLoad: true);
            }
        }
    }
}